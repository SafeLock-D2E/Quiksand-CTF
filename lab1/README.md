# ROS 2 Topic ä¿¡æ¯æ³„æ¼ï¼ˆLab1)

> **Level 1ï¼šTopic ä¿¡æ¯æ³„æ¼ï¼ˆDiscovery æ”»å‡»ï¼‰**

> æ”»å‡»ç›®æ ‡ï¼šé€šè¿‡ Discovery æ”»å‡»è®¢é˜…æš´éœ²çš„æ•æ„Ÿ Topicï¼ŒèŽ·å–å…¶ä¸­åŒ…å«çš„æ•æ„Ÿä¿¡æ¯åŠ Flagã€‚

---

# 1. é¶åœºèƒŒæ™¯

æ­¤æ¬¡æ¸—é€æµ‹è¯•çš„ç›®æ ‡ä¸º **Quiksand Lab2** çŽ¯å¢ƒï¼Œæ ¸å¿ƒå›´ç»• ROS 2 ç³»ç»Ÿçš„ Topic ä¿¡æ¯æ³„æ¼æ¼æ´žå±•å¼€ã€‚

åœ¨é»˜è®¤é…ç½®ä¸‹ï¼š

- é˜²å®ˆç­–ç•¥æœªå…¬å¸ƒ launch æ–‡ä»¶ï¼Œæœªé…ç½® Topic è®¿é—®æŽ§åˆ¶

- ROS 2 èŠ‚ç‚¹åŸºäºŽ DDS åè®®é€šä¿¡ï¼Œé»˜è®¤å¼€å¯ Discovery æœºåˆ¶ï¼ŒçŽ¯å¢ƒå˜é‡é…ç½®ä¸º ROS_DOMAIN_ID=30

- ç³»ç»Ÿä¸­è¿è¡Œâ€œè„†å¼±çš„ Publisherâ€ï¼ŒæŒç»­å‘ç‰¹å®š Topic å‘å¸ƒåŒ…å«æ•æ„Ÿä¿¡æ¯çš„æ¶ˆæ¯

è¿™æ„å‘³ç€ï¼š

> **ä»»ä½•èƒ½æŽ¥å…¥åŒä¸€ DDS Domainï¼ˆDomain 30ï¼‰çš„èŠ‚ç‚¹ï¼Œéƒ½å¯ä»¥è®¢é˜…æš´éœ²çš„æ•æ„Ÿ Topicï¼Œæ— éœ€é¢å¤–æŽˆæƒå³å¯èŽ·å–å…¶ä¸­çš„æ•æ„Ÿæ•°æ®ã€‚**

åœ¨çœŸå®žæœºå™¨äººç³»ç»Ÿä¸­ï¼Œå¦‚æžœæŽ§åˆ¶ç±»ã€é…ç½®ç±»æˆ–æ¶‰å¯†ç±» Topicï¼ˆå¦‚ /robot_cmdï¼‰æœªåŠ é˜²æŠ¤ï¼Œå°†ç›´æŽ¥å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€æœºå™¨äººè¿è¡ŒçŠ¶æ€è¢«éžæ³•ç›‘æŽ§ç­‰é£Žé™©ã€‚

---

# 2. æ”»å‡»åœºæ™¯è¯´æ˜Ž

## 2.1 ç³»ç»Ÿè§’è‰²

|è§’è‰²|è¯´æ˜Ž|
|---|---|
|è„†å¼±çš„ Publisher|ç›®æ ‡èŠ‚ç‚¹ï¼Œè¿è¡ŒäºŽ Docker å®¹å™¨å†…ï¼ŒæŒç»­å‘ /robot_cmd Topic å‘å¸ƒå«æ•æ„Ÿä¿¡æ¯çš„æ¶ˆæ¯|
|monitor_node|ç›‘æŽ§èŠ‚ç‚¹ï¼Œæ£€æµ‹åˆ° /robot_cmd Topic è¢«æœªæŽˆæƒè®¢é˜…åŽï¼ŒåŒæ­¥è¾“å‡º Flag|
|æ”»å‡»è€…ï¼ˆçº¢é˜Ÿï¼‰|å®¿ä¸»æœº/å®¹å™¨å†…æ”»å‡»è€…ï¼Œä½¿ç”¨ ROS 2 å‘½ä»¤è¡Œå·¥å…·å®žæ–½ Discovery æ”»å‡»ï¼Œè®¢é˜…æ•æ„Ÿ Topic|
---

## 2.2 æ”»å‡»ç›®æ ‡

- ðŸŽ¯ Topicï¼šæ•æ„Ÿ Topic `/robot_cmd`ï¼ˆæ ¸å¿ƒç›®æ ‡ï¼ŒåŒ…å«æ•æ„Ÿ Flag ä¿¡æ¯ï¼‰

- ðŸŽ¯ åè®®/å·¥å…·ï¼šDDS Discovery åè®®ï¼ˆDomain 30ï¼‰ã€ROS 2 å‘½ä»¤è¡Œå·¥å…·ã€Docker

- ðŸŽ¯ æ•ˆæžœï¼š
        

    - å‘çŽ°ç›®æ ‡ç³»ç»Ÿä¸­æš´éœ²çš„ /robot_cmd Topic

    - è®¢é˜…è¯¥ Topicï¼ŒèŽ·å–å…¶ä¸­åŒ…å«çš„æ•æ„Ÿæ¶ˆæ¯åŠ Flag

    - éªŒè¯ ROS 2 Topic ä¿¡æ¯æ³„æ¼çš„æ¼æ´žé£Žé™©åŠåˆ©ç”¨æ–¹å¼

---

# 3. é¶åœºå¯åŠ¨æ–¹å¼

åœ¨ `lab2` ç›®å½•ä¸‹æž„å»ºå¹¶å¯åŠ¨é¶åœºï¼ˆæŒ‡å®š ROS_DOMAIN_ID=30ï¼‰ï¼š

```bash
sudo docker rm -f quiksand_lab1>/dev/null
sudo docker build -t ros2-topic-leak-lab .
sudo docker run -it -e ROS_DOMAIN_ID=30 --name quiksand_lab2 ros2-topic-leak-lab
```

å¯åŠ¨æˆåŠŸåŽï¼Œå®¹å™¨å†…ä¼šè‡ªåŠ¨ï¼š

- source ROS 2 çŽ¯å¢ƒï¼ŒåŠ è½½ ROS_DOMAIN_ID=30 é…ç½®

- å¯åŠ¨â€œè„†å¼±çš„ Publisherâ€èŠ‚ç‚¹ï¼Œå¼€å§‹å‘ /robot_cmd å‘å¸ƒæ¶ˆæ¯

- å¯åŠ¨ç›‘æŽ§èŠ‚ç‚¹ `monitor_node`ï¼Œç›‘å¬ Topic è®¿é—®çŠ¶æ€

- ç›´æŽ¥è¿›å…¥äº¤äº’ shellï¼Œæç¤ºèŠ‚ç‚¹å¯åŠ¨æˆåŠŸ

---

# 4. æ”»å‡»æ–¹å¼ä¸€ï¼šROS 2 å‘½ä»¤è¡Œè®¢é˜…ï¼ˆå¿«é€ŸéªŒè¯ï¼‰

> é€‚ç”¨äºŽ CTF / æ•™å­¦åœºæ™¯çš„æœ€ç®€å•æ”»å‡»æ–¹å¼ï¼Œæ— éœ€å¤æ‚è„šæœ¬ï¼Œç›´æŽ¥é€šè¿‡ ROS 2 åŽŸç”Ÿå‘½ä»¤è®¢é˜… Topicã€èŽ·å–æ•æ„Ÿä¿¡æ¯ã€‚

## 4.1 æ”»å‡»å‘½ä»¤ï¼ˆå®¹å™¨å†…/å®¿ä¸»æœºæ‰§è¡Œï¼‰

ç¬¬ä¸€æ­¥ï¼šåˆ—å‡ºç›®æ ‡ç³»ç»Ÿä¸­æ‰€æœ‰æš´éœ²çš„ Topicï¼ˆç¡®è®¤ /robot_cmd å­˜åœ¨ï¼‰

```bash
ros2 topic list
```

ç¬¬äºŒæ­¥ï¼šè®¢é˜…ç›®æ ‡ Topic /robot_cmdï¼Œè¯»å–å…¶ä¸­çš„æ¶ˆæ¯å†…å®¹

```bash
ros2 topic echo /robot_cmd
```

## 4.2 æ”»å‡»åŽŸç†

- ROS 2 å‘½ä»¤è¡Œå·¥å…·ï¼ˆ`ros2 topic`ï¼‰åŸºäºŽ DDS Discovery åè®®å·¥ä½œï¼Œå¯è‡ªåŠ¨å‘çŽ°åŒä¸€ Domainï¼ˆ30ï¼‰å†…çš„æ‰€æœ‰ Topic

- ç›®æ ‡ç³»ç»Ÿæœªå¯¹ /robot_cmd Topic é…ç½®è®¿é—®æŽ§åˆ¶ï¼Œæœªé™åˆ¶è®¢é˜…æƒé™ï¼Œå…è®¸ä»»æ„èŠ‚ç‚¹è®¢é˜…

- ROS 2 é»˜è®¤ Topic æ•°æ®ä¼ è¾“ä¸ºæ˜Žæ–‡ï¼Œæ— éœ€ä¼ªé€ èŠ‚ç‚¹èº«ä»½ï¼Œç›´æŽ¥é€šè¿‡åŽŸç”Ÿå‘½ä»¤å³å¯å®Œæˆè®¢é˜…å’Œæ¶ˆæ¯è¯»å–ï¼Œæ”»å‡»æˆæœ¬æžä½Ž

## 4.3 æˆåŠŸæ ‡å¿—

å‘½ä»¤æ‰§è¡ŒåŽï¼Œå°†æˆåŠŸåˆ—å‡º Topic å¹¶æŽ¥æ”¶åˆ°æ•æ„Ÿæ¶ˆæ¯ï¼Œå®¹å™¨å†…è¾“å‡ºåº”å‡ºçŽ°ï¼š

```text
# ros2 topic list è¾“å‡º
/parameter_events
/robot_cmd
/rosout

# ros2 topic echo /robot_cmd è¾“å‡º
data: Hello ROS2 | FLAG=flag{Quiksand_lab1_001}
---

[FATAL] [monitor_node]: ðŸ´ FLAG: flag{Quiksand_lab1_001}
```

---

# 5. æ”»å‡»æ–¹å¼äºŒï¼šDDS æµé‡æŠ“åŒ…ï¼ˆçœŸå®žæ”»å‡»ï¼‰

> æ›´è´´è¿‘çœŸå®žæ”»å‡»åœºæ™¯çš„æ–¹å¼ï¼Œæ”»å‡»è€…æ— éœ€ç›´æŽ¥æ‰§è¡Œ ROS 2 å‘½ä»¤ï¼Œé€šè¿‡æŠ“åŒ…å³å¯èŽ·å– Topic æ¶ˆæ¯å†…å®¹ï¼Œæ”»å‡»è¡Œä¸ºæ›´éšè”½ã€‚

## 5.1 é…ç½®æŠ“åŒ…çŽ¯å¢ƒï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰

```bash
# æŸ¥çœ‹ç›®æ ‡å®¹å™¨çš„ç½‘ç»œæŽ¥å£ï¼ˆç¡®è®¤å®¹å™¨ç½‘ç»œå¯è¢«æŠ“åŒ…ï¼‰
sudo docker inspect quiksand_lab2 | grep NetworkSettings -A 10

# ä½¿ç”¨ TCPDump æŠ“åŒ…ï¼ˆæŒ‡å®šå®¹å™¨ç½‘ç»œæŽ¥å£ï¼Œè¿‡æ»¤ DDS ç›¸å…³ç«¯å£ï¼‰
sudo tcpdump -i any port 7400-7500 -w dds_topic_leak.pcap

# æˆ–ä½¿ç”¨ Wireshark å›¾å½¢åŒ–æŠ“åŒ…ï¼Œç­›é€‰ RTPS åè®®ï¼ˆDDS åº•å±‚åè®®ï¼‰
sudo wireshark
```

## 5.2 è§£æž DDS æµé‡ï¼Œæå– Topic æ¶ˆæ¯

1. å¯åŠ¨æŠ“åŒ…åŽï¼Œç¡®ä¿å®¹å™¨å†…â€œè„†å¼±çš„ Publisherâ€æ­£å¸¸è¿è¡Œï¼ˆæŒç»­å‘å¸ƒ /robot_cmd æ¶ˆæ¯ï¼‰

2. åœæ­¢æŠ“åŒ…ï¼Œç”¨ Wireshark æ‰“å¼€ `dds_topic_leak.pcap` æ–‡ä»¶

3. è¿‡æ»¤è§„åˆ™ï¼š`rtps`ï¼ˆç­›é€‰ DDS åº•å±‚ RTPS åè®®æ•°æ®åŒ…ï¼‰ï¼Œå®šä½ Topic æ¶ˆæ¯ä¼ è¾“åŒ…

4. è§£æžæ•°æ®åŒ…ä¸­çš„â€œDataâ€å­—æ®µï¼Œæå– /robot_cmd Topic çš„æ¶ˆæ¯å†…å®¹ï¼Œå³å¯èŽ·å–æ•æ„Ÿä¿¡æ¯ `FLAG=flag{Quiksand_lab1_001}`

## 5.3 æ”»å‡»æ•ˆæžœ

- æ— éœ€è¿›å…¥å®¹å™¨ã€æ— éœ€æ‰§è¡Œ ROS 2 å‘½ä»¤ï¼Œä»…é€šè¿‡ç½‘ç»œæŠ“åŒ…å³å¯èŽ·å– /robot_cmd Topic çš„æ•æ„Ÿæ¶ˆæ¯

- æ”»å‡»è¡Œä¸ºéšè”½ï¼Œä¸ä¸»åŠ¨ä¸Žç›®æ ‡èŠ‚ç‚¹äº¤äº’ï¼Œä¸æ˜“è¢« monitor_node ç›´æŽ¥æ£€æµ‹ï¼ˆä»…æŠ“åŒ…ä¸è®¢é˜…ï¼Œå¯èƒ½è§„é¿éƒ¨åˆ†ç›‘æŽ§ï¼‰

- å¯åŒæ—¶æ•èŽ·ç³»ç»Ÿä¸­æ‰€æœ‰æš´éœ² Topic çš„å…ƒæ•°æ®åŠæ¶ˆæ¯å†…å®¹ï¼Œä¸ºåŽç»­è¿›ä¸€æ­¥æ”»å‡»é“ºåž«

---

# 6. æ¼æ´žæˆå› åˆ†æž

## 6.1 æ ¸å¿ƒé—®é¢˜

- Topic æ•°æ®ä¼ è¾“æœªåŠ å¯†ï¼šROS 2 é»˜è®¤æƒ…å†µä¸‹ï¼ŒTopic æ¶ˆæ¯ä¼ è¾“ä¸ºæ˜Žæ–‡ï¼Œæœªé‡‡ç”¨ä»»ä½•åŠ å¯†æœºåˆ¶ï¼Œæ”»å‡»è€…å¯é€šè¿‡æŠ“åŒ…è½»æ¾è§£æžæ•æ„Ÿæ•°æ®

- ç¼ºä¹ Topic è®¿é—®æŽ§åˆ¶ï¼šROS 2 ç³»ç»Ÿæœªé…ç½®è®¿é—®æŽ§åˆ¶ç­–ç•¥ï¼Œæœªå¯¹ /robot_cmd ç­‰æ•æ„Ÿ Topic è®¾ç½®è®¢é˜…æƒé™ï¼Œå…è®¸ä»»æ„èŠ‚ç‚¹è®¢é˜…

- æ•æ„Ÿæ•°æ®æš´éœ²ï¼š/robot_cmd Topic æœ¬åº”æ˜¯ç³»ç»Ÿå†…éƒ¨é€šä¿¡ Topicï¼Œå´æœªåšä»»ä½•é˜²æŠ¤ï¼Œç›´æŽ¥å°†åŒ…å« Flag çš„æ•æ„Ÿä¿¡æ¯æš´éœ²åœ¨å…¬å…± Domain ä¸­

- Domain é…ç½®ä¸å½“ï¼šæœªåˆç†è§„åˆ’ ROS_DOMAIN_IDï¼Œæœªé€šè¿‡ Domain éš”ç¦»é™åˆ¶ Topic æš´éœ²èŒƒå›´ï¼Œå¯¼è‡´å¤–éƒ¨èŠ‚ç‚¹å¯è½»æ˜“æŽ¥å…¥å¹¶èŽ·å–ä¿¡æ¯

## 6.2 æ”»å‡»æœ¬è´¨

> **ROS 2 Topic é€šä¿¡çš„ä¿¡ä»»æœºåˆ¶è¢«æ»¥ç”¨ï¼ŒæœªæŽˆæƒè®¿é—®é˜²æŠ¤ç¼ºå¤±**

ä»»ä½•èŠ‚ç‚¹åªè¦ï¼š

- æŽ¥å…¥ç›®æ ‡ ROS_DOMAIN_IDï¼ˆæœ¬æ¬¡ä¸º 30ï¼‰ï¼Œä¸Žç›®æ ‡èŠ‚ç‚¹å¤„äºŽåŒä¸€ DDS Domain

- æ”¯æŒ DDS RTPS åè®®ï¼Œå³å¯å‘çŽ°å¹¶è®¢é˜…æœªå—ä¿æŠ¤çš„ Topic

æ— éœ€ç»•è¿‡ä»»ä½•é˜²æŠ¤ï¼Œç›´æŽ¥åˆ©ç”¨ ROS 2 é»˜è®¤é…ç½®çš„å®‰å…¨çŸ­æ¿ï¼Œå³å¯å®Œæˆæ•æ„Ÿä¿¡æ¯çªƒå–ã€‚

---

# 7. é˜²å®ˆæ–¹å‘ï¼ˆé¢„å‘Šï¼‰

è¯¥é¶åœºå¯ç”¨äºŽéªŒè¯ä»¥ä¸‹é˜²å¾¡æŽªæ–½ï¼ŒåŠ å›º ROS 2 èŠ‚ç‚¹å®‰å…¨ï¼ŒæŠµå¾¡ Topic ä¿¡æ¯æ³„æ¼æ”»å‡»ï¼š

- åŠ å¯†é€šä¿¡ï¼šå¯ç”¨ SROS2 å®‰å…¨æ¡†æž¶ï¼Œå¯¹ ROS 2 æ¶ˆæ¯å’Œ Topic æ•°æ®è¿›è¡Œç«¯åˆ°ç«¯åŠ å¯†ï¼Œé˜²æ­¢æŠ“åŒ…è§£æž

- Topic è®¿é—®æŽ§åˆ¶ï¼šé€šè¿‡ `permissions.xml` æ–‡ä»¶é…ç½® Topic è®¿é—®æŽ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰ï¼Œä»…å…è®¸æŽˆæƒèŠ‚ç‚¹è®¢é˜…/å‘å¸ƒæ•æ„Ÿ Topic

- é™åˆ¶æš´éœ²èŒƒå›´ï¼šåˆç†é…ç½® ROS_DOMAIN_IDï¼Œé€šè¿‡ Domain éš”ç¦»åˆ’åˆ†é€šä¿¡èŒƒå›´ï¼Œé¿å…æ•æ„Ÿ Topic è¢«å¤–éƒ¨èŠ‚ç‚¹å‘çŽ°

- QoS ç­–ç•¥ä¼˜åŒ–ï¼šé…ç½®åˆé€‚çš„ QoS ç­–ç•¥ï¼Œé™åˆ¶ Topic æ¶ˆæ¯çš„ä¼ æ’­èŒƒå›´å’ŒæŽ¥æ”¶è€…

- å®‰å…¨å®¡è®¡ï¼šå®šæœŸæŽ’æŸ¥ç³»ç»Ÿä¸­æš´éœ²çš„ Topicã€æœåŠ¡å’Œå‚æ•°ï¼ŒåŠæ—¶å‘çŽ°å¹¶æ•´æ”¹æœªæŽˆæƒæš´éœ²çš„æ•æ„Ÿèµ„æº

å¼€å¯é˜²å®ˆåŽï¼š

> æ”»å‡»è€…æ— æ³•é€šè¿‡å‘½ä»¤è¡Œè®¢é˜… /robot_cmd Topicã€æ— æ³•é€šè¿‡æŠ“åŒ…è§£æžæ•æ„Ÿæ•°æ®ï¼Œæ•æ„Ÿä¿¡æ¯å°†è¢«ä¸¥æ ¼ä¿æŠ¤ã€‚

---

# 8. Flag

```text
flag{Quiksand_lab1_001}
```

---

# 9. é€‚ç”¨åœºæ™¯

- ROS 2 å®‰å…¨æ•™å­¦ï¼ˆTopic ä¿¡æ¯æ³„æ¼æ”»å‡»åŽŸç†è®²è§£ï¼‰

- æœºå™¨äººå®‰å…¨å®žéªŒï¼ˆTopic é˜²æŠ¤æŽªæ–½éªŒè¯ï¼‰

- CTF æ”»é˜²é¶åœºï¼ˆROS 2 ä¸“é¡¹é¢˜åž‹è®¾è®¡ï¼‰

- ç ”ç©¶ç”Ÿ/æœ¬ç§‘è¯¾ç¨‹å®žéªŒï¼ˆåµŒå…¥å¼/æœºå™¨äººå®‰å…¨æ–¹å‘ï¼‰

---

**Author**: ROS 2 Security Lab

**Level**: Intermediate / Offensive
> 